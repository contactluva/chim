$(document).ready(function() {
    var modalOpen = false; //

    var modal = document.getElementById("videoModal");
    var largeVideo = document.getElementById("large-video");
    var closeBtn = document.getElementsByClassName("close")[0];
    var modalVideoSource = document.getElementById("modal-video-source");

    var smallVideos = document.querySelectorAll(".small-video video");
    var spmuaElements = document.querySelectorAll(".spmua");

    largeVideo.setAttribute("playsinline", "");
    largeVideo.setAttribute("webkit-playsinline", "");

    smallVideos.forEach(function (video, index) {
        video.addEventListener("click", function () {
            
            modalOpen = true;

       
            var videoSrc = video.src;
            var posterSrc = video.poster;

            modalVideoSource.src = videoSrc;
            largeVideo.poster = posterSrc;
            largeVideo.load(); // 

            
            largeVideo.muted = false; //
            largeVideo.loop = false; // 

            modal.style.display = "block";
            largeVideo.style.filter = "brightness(1.1)"; 
            largeVideo.play(); // 
            video.pause(); // 

            
            spmuaElements.forEach(function (spmua) {
                spmua.style.display = "none";
            });

           
            var spmuaElement = spmuaElements[index];
            spmuaElement.style.display = "block";

           
            var giaSpElement = spmuaElement.querySelector(".giasp");
            if (giaSpElement) {
                var giaSpValue = giaSpElement.textContent.trim(); 
                var formattedValue = Number(giaSpValue).toLocaleString('de-DE'); 
                giaSpElement.textContent = formattedValue; // 
            }
        });
    });

   
    closeBtn.onclick = function () {
        modal.style.display = "none";
        largeVideo.pause(); //

        
        largeVideo.style.filter = "";

   
        spmuaElements.forEach(function (spmua) {
            spmua.style.display = "none";
        });

        
        modalOpen = false;
    };

    window.onclick = function (event) {
        if (event.target == largeVideo || event.target == closeBtn) {
            modal.style.display = "none";
            largeVideo.pause(); // 

            // 
            largeVideo.style.filter = "";

            //
            spmuaElements.forEach(function (spmua) {
                spmua.style.display = "none";
            });

            // 
            modalOpen = false;
        }
    };
});
